import{g as e,j as t}from"./index-D9JmXA_p.js";import{r as s,c as a}from"./react-vendor-BnDW3H_d.js";import{z as r,Z as i,S as o}from"./ui-vendor-DN-uZ73V.js";const n=s.memo(({product:n})=>{const l=a(),[d,c]=s.useState(!1),[m,x]=s.useState(!1),h=s.useMemo(()=>n.mrp>n.price?Math.round((n.mrp-n.price)/n.mrp*100):0,[n.mrp,n.price]),p=s.useMemo(()=>{var e;return(null==(e=n.images)?void 0:e[0])||n.image||"/placeholder-medicine.jpg"},[n.images,n.image]),u=s.useCallback(async()=>{c(!0);try{r.success(`${n.name} added to cart!`)}catch(e){r.error("Failed to add to cart")}finally{c(!1)}},[n._id,n.name]),g=s.useCallback(async()=>{const t=e();if(!t){const e=encodeURIComponent(`/checkout?productId=${n._id}&quantity=1`);return void l(`/login?redirect=${e}`)}x(!0);try{const e=await fetch("https://medical-shop-backend.vercel.app/api/cart/items",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({productId:n._id,quantity:1})}),s=await e.json();if(!e.ok||!s.success)throw new Error(s.message||"Failed to add product to cart");r.success("Product added to cart!"),l("/checkout")}catch(s){r.error(s.message||"Failed to proceed with purchase")}finally{x(!1)}},[n._id,l]);return t.jsxs("div",{className:"bg-white rounded-md shadow-sm border border-gray-200 overflow-hidden hover:shadow-md hover:border-medical-300 transition-all duration-200 flex flex-col",children:[t.jsxs("div",{className:"h-20 w-full bg-gray-50 relative overflow-hidden flex items-center justify-center",children:[t.jsx("img",{src:p,alt:n.name,className:"h-full w-full object-contain p-1",loading:"lazy",decoding:"async",onError:e=>{e.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="400"%3E%3Crect fill="%23E5E7EB" width="400" height="400"/%3E%3Ctext fill="%239CA3AF" font-family="sans-serif" font-size="18" x="50%25" y="50%25" text-anchor="middle" dy=".3em"%3EMedicine%3C/text%3E%3C/svg%3E'}}),0===n.stock&&t.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:t.jsx("span",{className:"bg-red-600 text-white px-1.5 py-0.5 rounded text-[10px] font-medium",children:"Out of Stock"})}),h>0&&t.jsx("div",{className:"absolute top-1 right-1",children:t.jsxs("span",{className:"bg-red-500 text-white text-[10px] px-1.5 py-0.5 rounded font-semibold",children:[h,"% OFF"]})})]}),t.jsxs("div",{className:"p-1.5 flex flex-col flex-grow",children:[n.brand&&t.jsx("p",{className:"text-[10px] text-gray-400 mb-0.5 line-clamp-1",children:n.brand}),t.jsx("h3",{className:"text-xs font-semibold text-gray-900 mb-1 line-clamp-2 leading-tight",children:n.name}),t.jsxs("div",{className:"flex items-baseline gap-1 mb-1 flex-wrap",children:[t.jsxs("span",{className:"text-sm font-bold text-gray-900",children:["₹",n.price.toLocaleString()]}),n.mrp>n.price&&t.jsxs("span",{className:"text-[10px] text-gray-500 line-through",children:["₹",n.mrp.toLocaleString()]})]}),n.stock>0&&n.stock<10&&t.jsxs("p",{className:"text-[10px] text-orange-600 mb-1 font-medium",children:["Only ",n.stock," left"]}),t.jsxs("div",{className:"flex flex-row gap-1.5 mt-auto",children:[t.jsx("button",{onClick:g,disabled:m||0===n.stock,className:"group flex-1 flex items-center justify-center gap-1 py-1.5 bg-orange-600 hover:bg-orange-700 text-white text-[11px] font-medium rounded transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed hover:scale-105 hover:shadow-lg active:scale-95 transform",children:m?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),t.jsx("span",{children:"Processing..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(i,{size:11,className:"transition-transform duration-300 group-hover:rotate-12 group-hover:scale-110"}),t.jsx("span",{className:"transition-all duration-300",children:"Buy Now"})]})}),t.jsx("button",{onClick:u,disabled:d||0===n.stock,className:"group flex-1 flex items-center justify-center gap-1 py-1.5 bg-medical-600 hover:bg-medical-700 text-white text-[11px] font-medium rounded transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed hover:scale-105 hover:shadow-lg active:scale-95 transform",children:d?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),t.jsx("span",{children:"Adding..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(o,{size:11,className:"transition-transform duration-300 group-hover:scale-110 group-hover:-translate-y-0.5"}),t.jsx("span",{className:"transition-all duration-300",children:"Add to Cart"})]})})]}),t.jsxs("div",{className:"mt-1 flex items-center justify-between text-[10px] text-gray-500",children:[t.jsx("span",{className:"truncate",children:n.category||"Product"}),n.stock>0&&t.jsx("span",{className:"text-green-600 font-medium ml-1",children:"In Stock"})]})]})]})});n.displayName="ProductCard";export{n as P};
