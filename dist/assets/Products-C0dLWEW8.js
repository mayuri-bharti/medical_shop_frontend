import{j as e}from"./index-D9JmXA_p.js";import{f as s,r as t}from"./react-vendor-BnDW3H_d.js";import{u as a}from"./query-vendor-DOOTwIbN.js";import{a as r}from"./api-BmK1iuKu.js";import{P as o}from"./PageCarousel-9_xLH3GO.js";import{P as i}from"./ProductCard-D9TLvMUF.js";import{h as c}from"./ui-vendor-DN-uZ73V.js";const l=()=>{var l,n,d,u,m,p,h;const[g,x]=s(),[f,v]=t.useState(g.get("search")||""),[y,j]=t.useState(g.get("category")||""),[b,N]=t.useState("name"),w=t.useDeferredValue(f),{data:P,isLoading:C,error:S}=a(["products",w,y,b],async()=>{try{r.defaults.baseURL;const e=(await r.get("/products",{params:{search:w||void 0,category:y||void 0,sort:b||void 0,page:1,limit:20},timeout:6e4,headers:{Accept:"application/json","Content-Type":"application/json"}})).data;if(e&&void 0!==e.success){if(e.success&&e.products)return e;throw new Error(e.message||"Failed to load products")}if(e&&(e.products||Array.isArray(e))){return{success:!0,products:e.products||e||[],pagination:e.pagination||{}}}return{success:!0,products:[],pagination:{}}}catch(e){throw e}},{keepPreviousData:!0,retry:2,retryDelay:1e3,staleTime:3e4,cacheTime:3e5}),R=t.useMemo(()=>(null==P?void 0:P.products)||[],[null==P?void 0:P.products]),k=t.useMemo(()=>["Prescription Medicines","OTC Medicines","Wellness Products","Personal Care","Health Supplements","Baby Care","Medical Devices","Ayurvedic Products"],[]),L=t.useMemo(()=>[{src:"https://images.unsplash.com/photo-1587854692152-cbe660dbde88?w=1200&h=400&fit=crop",alt:"Medicine Collection",title:"Huge Selection of Medicines",description:"Browse thousands of authentic medicines and healthcare products"},{src:"https://images.unsplash.com/photo-1584308666744-24d5c474f2ae?w=1200&h=400&fit=crop",alt:"Special Offers",title:"Special Offers & Discounts",description:"Save up to 30% on selected medicines and wellness products"},{src:"https://images.unsplash.com/photo-1563213126-a4273aed2016?w=1200&h=400&fit=crop",alt:"Verified Products",title:"100% Verified Products",description:"All medicines verified and approved by health authorities"}],[]),T=t.useCallback(e=>{e.preventDefault();const s=new URLSearchParams;f&&s.set("search",f),y&&s.set("category",y),x(s,{replace:!0})},[f,y,x]);if(C)return e.jsx("div",{className:"flex justify-center items-center min-h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-medical-600"})});if(S){const s=(null==(n=null==(l=S.response)?void 0:l.data)?void 0:n.message)||S.message||"Unknown error occurred",t=null==(d=S.response)?void 0:d.status,a="ERR_NETWORK"===S.code||(null==(u=S.message)?void 0:u.includes("Network Error")),o="ECONNABORTED"===S.code||(null==(m=S.message)?void 0:m.includes("timeout")),i=(null==(p=S.message)?void 0:p.includes("CORS"))||(null==(h=S.message)?void 0:h.includes("cors"));return e.jsx("div",{className:"text-center py-12 px-4",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-red-600 font-semibold text-lg mb-2",children:a?"Network Error":o?"Connection Timeout":i?"Connection Error":"Error loading products"}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:a?"Please check your internet connection and try again. If the problem persists, the server may be temporarily unavailable.":o?"The request took too long. This may be due to a slow connection. Please check your internet and try again.":i?"Unable to connect to the server. Please try again or contact support if the issue persists.":s}),t&&e.jsxs("p",{className:"text-gray-500 text-xs mb-4",children:["Status: ",t]}),e.jsxs("p",{className:"text-gray-400 text-xs mb-4 font-mono break-all",children:["API URL: ",r.defaults.baseURL||"Not set",e.jsx("br",{}),"Full URL: ",r.defaults.baseURL?`${r.defaults.baseURL}/products`:"Not set"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-medical-600 hover:bg-medical-700 text-white font-medium rounded-lg transition-colors",children:"Reload Page"}),e.jsx("button",{onClick:()=>{window.location.href="/products"},className:"px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-lg transition-colors",children:"Try Again"})]})]})})}return e.jsxs("div",{className:"space-y-6",children:[e.jsx(o,{images:L,autoSlide:!0,interval:4e3,height:"h-32 md:h-40 lg:h-48"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("form",{className:"flex-1 relative",onSubmit:T,children:[e.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search medicines and products...",className:"input-field pl-10",value:f,onChange:e=>v(e.target.value)})]}),e.jsxs("select",{className:"input-field md:w-48",value:y,onChange:e=>{j(e.target.value);const s=new URLSearchParams(g);e.target.value?s.set("category",e.target.value):s.delete("category"),f?s.set("search",f):s.delete("search"),x(s,{replace:!0})},children:[e.jsx("option",{value:"",children:"All Categories"}),k.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("select",{className:"input-field md:w-48",value:b,onChange:e=>N(e.target.value),children:[e.jsx("option",{value:"name",children:"Sort by Name"}),e.jsx("option",{value:"price_asc",children:"Price: Low to High"}),e.jsx("option",{value:"price_desc",children:"Price: High to Low"}),e.jsx("option",{value:"rating",children:"Sort by Rating"})]})]}),(null==R?void 0:R.length)>0?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-2 md:gap-3",children:R.map(s=>e.jsx(i,{product:s},s._id))}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600",children:"No products found matching your criteria."})})]})};export{l as default};
