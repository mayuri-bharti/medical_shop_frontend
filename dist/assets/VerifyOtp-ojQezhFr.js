const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-D9JmXA_p.js","assets/react-vendor-BnDW3H_d.js","assets/query-vendor-DOOTwIbN.js","assets/ui-vendor-DN-uZ73V.js","assets/index-D4VMTh2V.css"])))=>i.map(i=>d[i]);
import{j as e,v as s,a as t,_ as a}from"./index-D9JmXA_p.js";import{f as r,c as n,r as l}from"./react-vendor-BnDW3H_d.js";import{c,m as i,A as d,l as o,z as m}from"./ui-vendor-DN-uZ73V.js";import"./query-vendor-DOOTwIbN.js";const x=()=>{const[x]=r(),u=x.get("phone")||"",h=n(),[f,p]=l.useState(""),[j,g]=l.useState(!1),[b,y]=l.useState(""),[v,N]=l.useState(null),[w,O]=l.useState(0),[P,T]=l.useState(!1);l.useEffect(()=>{if(w>0){const e=setInterval(()=>{O(e=>e<=1?(T(!0),0):e-1)},1e3);return()=>clearInterval(e)}},[w]),l.useEffect(()=>{u&&O(60)},[u]),l.useEffect(()=>{u||h("/login")},[u,h]);return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-medical-50 to-medical-100 px-4",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-medical-600 rounded-2xl mb-4",children:e.jsx(c,{className:"text-white",size:32})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Verify OTP"}),e.jsxs("p",{className:"text-gray-600",children:["Enter the code sent to +91 ",u]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("button",{onClick:()=>h("/login"),className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 mb-6 transition-colors",children:[e.jsx(i,{size:20}),e.jsx("span",{className:"text-sm font-medium",children:"Change number"})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),y(""),g(!0);try{const e=await s(u,f);e.success&&(t(e.data.accessToken),m.success("Login successful!"),h("/"))}catch(a){const e=a.message||"Invalid OTP. Please try again.";y(e),m.error(e),void 0!==a.attemptsLeft&&N(a.attemptsLeft)}finally{g(!1)}},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-4",children:"Enter 6-digit OTP"}),e.jsx("div",{className:"flex justify-center space-x-2",children:[0,1,2,3,4,5].map(s=>e.jsx("input",{type:"text",inputMode:"numeric",maxLength:1,value:f[s]||"",onChange:e=>{const t=f.split("");if(t[s]=e.target.value,(e=>{const s=e.replace(/\D/g,"");s.length<=6&&p(s)})(t.join("")),e.target.value&&s<5){const t=e.target.parentElement.children[s+1];t&&t.focus()}},onKeyDown:e=>{if("Backspace"===e.key&&!f[s]&&s>0){const t=e.target.parentElement.children[s-1];t&&t.focus()}},className:"w-12 h-14 text-center text-xl font-semibold border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-medical-500 focus:border-medical-500 transition-all",disabled:j,required:!0},s))})]}),null!==v&&v>0&&e.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsx(d,{className:"text-yellow-600",size:20}),e.jsxs("p",{className:"text-sm text-yellow-600",children:[v," attempt",1!==v?"s":""," remaining"]})]}),b&&e.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx(d,{className:"text-red-600",size:20}),e.jsx("p",{className:"text-sm text-red-600",children:b})]}),e.jsx("button",{type:"submit",disabled:j||6!==f.length,className:"w-full flex items-center justify-center space-x-2 py-3 px-4 bg-medical-600 hover:bg-medical-700 text-white font-medium rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Verifying..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(o,{size:20}),e.jsx("span",{children:"Verify OTP"})]})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Didn't receive the code?"}),P?e.jsx("button",{type:"button",onClick:async()=>{if(P)try{const{sendOtp:e}=await a(async()=>{const{sendOtp:e}=await import("./index-D9JmXA_p.js").then(e=>e.p);return{sendOtp:e}},__vite__mapDeps([0,1,2,3,4]));await e(u),m.success("OTP resent!"),O(60),T(!1)}catch(e){m.error("Failed to resend OTP")}},className:"text-medical-600 hover:text-medical-700 font-medium text-sm",children:"Resend OTP"}):e.jsxs("p",{className:"text-sm text-gray-500",children:["Resend OTP in ",w,"s"]})]})]})]})]})})};export{x as default};
